<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ward - Alias Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="text-white cyber-grid">
    <div class="cyber-border border-b border-white/20 bg-black px-4 py-2">
        <div class="flex items-center justify-between">
            <!-- top bar / nav bar ? -->
            <div class="flex items-center space-x-8">
                <h1 class="text-2xl font-bold glow-text tracking-wider">WARD</h1>
                <div class="flex space-x-1">
                    <div class="navbar-item" onclick="importFile()">
                        <span class="text-sm uppercase tracking-wider">Import</span>
                    </div>
                    <div class="navbar-item" onclick="exportFile()">
                        <span class="text-sm uppercase tracking-wider">Export</span>
                    </div>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button onclick="showHelpModal()" class="text-white/50 hover:text-white transition-colors" title="Help">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </button>
                <div id="unsaved-warning" class="hidden flex items-center space-x-2 text-red-500 unsaved-indicator">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                    </svg>
                    <span class="text-xs uppercase tracking-wider">Unsaved Changes</span>
                </div>
            </div>
        </div>
    </div>

    <div class="flex border-b border-white/20 bg-black/80 overflow-x-auto">
        <div id="tabs-container" class="flex">
            <!-- tabs will added here -->
        </div>
        <button onclick="showNewAliasModal()" class="px-4 py-2 hover:bg-white/10 transition-colors border-l border-white/20">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
        </button>
    </div>

    <!-- main content -->
    <div id="content-container" class="p-6">
            <div class="max-w-4xl mx-auto mt-10" id="welcome-message">
                <div class="cyber-border rounded-lg text-center p-12 flicker">
                    <h2 class="text-6xl font-bold glow-text tracking-widest">WARD</h2>
                    <p class="text-lg text-white/70 mt-2 uppercase tracking-wider">Alias Management System</p>

                    <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-8 text-left">
                        <div class="cyber-border-active p-6 rounded-lg">
                            <div class="flex items-center mb-3">
                                <svg class="w-6 h-6 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                                <h3 class="text-xl font-semibold uppercase tracking-wider">Create an Alias</h3>
                            </div>
                            <p class="text-white/60">
                                Click the <span class="font-bold text-white">+</span> button in the tab bar to generate a new, secure digital identity from scratch.
                            </p>
                        </div>

                        <div class="p-6">
                            <div class="flex items-center mb-3">
                                <svg class="w-6 h-6 mr-3 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg>
                                <h3 class="text-xl font-semibold uppercase tracking-wider">Manage Data</h3>
                            </div>
                            <p class="text-white/60">
                                Use the <span class="font-bold text-white">Import</span> and <span class="font-bold text-white">Export</span> buttons in the main navigation to load or save your encrypted alias files.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
    </div>

    <!-- password modal -->
    <div id="password-gate-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-[300]">
        <div class="cyber-border rounded-lg p-8 w-[500px]">
            <h1 class="text-3xl font-bold mb-2 uppercase tracking-wider text-center">WARD</h1>
            <p class="text-sm text-white/70 text-center mb-6">SECURE IDENTITY MANAGEMENT SYSTEM</p>
            <div class="border border-white/20 rounded p-4 mb-6 bg-white/5">
                <p class="text-xs uppercase tracking-wider text-white/50 mb-2">System Notice</p>
                <p class="text-sm">This is a closed system requiring authentication. Enter the system password to proceed.</p>
            </div>
            <input type="password" id="gate-password" class="mono-input w-full px-4 py-3 rounded text-white mb-4" placeholder="SYSTEM PASSWORD" autofocus>
            <button onclick="verifySystemPassword()" class="mono-button w-full py-3 rounded uppercase tracking-wider">ACCESS SYSTEM</button>
            <div id="gate-error" class="text-red-500 text-sm text-center mt-4 hidden">ACCESS DENIED - INVALID PASSWORD</div>
        </div>
    </div>

    <!-- help modal -->
    <div id="help-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50 hidden">
        <div class="cyber-border rounded-lg p-6 w-[600px] max-h-[80vh] overflow-y-auto">
            <h3 class="text-xl font-bold mb-6 uppercase tracking-wider">About WARD</h3>
            <div class="space-y-4 text-sm">
                <div>
                    <h4 class="font-bold uppercase tracking-wider text-white/70 mb-2">What is WARD?</h4>
                    <p class="text-white/90">WARD is an identity management system designed for creating and managing digital aliases. Each alias includes a complete identity profile with AI-generated photos, secure password storage, and 2FA authentication codes.</p>
                </div>
                <div>
                    <h4 class="font-bold uppercase tracking-wider text-white/70 mb-2">How to Use</h4>
                    <ol class="space-y-1 text-white/90">
                        <li>1. Click + to create a new alias</li>
                        <li>2. Select a username from generated options</li>
                        <li>3. AI face photo generates automatically</li>
                        <li>4. Lock the photo to save it permanently</li>
                        <li>5. Add passwords and TOTP secrets as needed</li>
                        <li>6. Export regularly to save encrypted backups</li>
                    </ol>
                </div>
    
                <div>
                    <h4 class="font-bold uppercase tracking-wider text-white/70 mb-2">Keyboard Shortcuts</h4>
                    <ul class="space-y-1 text-white/90 font-mono">
                        <li>Ctrl+N - New alias</li>
                        <li>Ctrl+S - Export file</li>
                        <li>Ctrl+O - Import file</li>
                        <li>ESC - Close modals</li>
                    </ul>
                </div>
            </div>
            <div class="flex justify-end mt-6">
                <button onclick="closeHelpModal()" class="mono-button px-4 py-2 rounded">CLOSE</button>
            </div>
        </div>
    </div>

    <!-- new alias modal -->
    <div id="new-alias-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50 hidden">
        <div class="cyber-border rounded-lg p-6 w-[600px] max-h-[80vh] overflow-y-auto">
            <h3 class="text-xl font-bold mb-6 uppercase tracking-wider">Generate New Identity</h3>
            <div id="preview-content" class="space-y-4 mb-6">
                <!-- preview shown here -->
            </div>
            <div class="flex justify-end space-x-3">
                <button onclick="regeneratePreview()" class="mono-button-secondary px-4 py-2 rounded">Regenerate</button>
                <button onclick="closeNewAliasModal()" class="mono-button-secondary px-4 py-2 rounded">Cancel</button>
                <button onclick="confirmNewAlias()" class="mono-button px-4 py-2 rounded">Create Alias</button>
            </div>
        </div>
    </div>

    <!-- password modal -->
    <div id="password-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50 hidden">
        <div class="cyber-border rounded-lg p-6 w-96">
            <h3 class="text-xl font-bold mb-4 uppercase tracking-wider">Enter Password</h3>
            <input type="password" id="modal-password" class="mono-input w-full px-4 py-2 rounded text-white mb-4" placeholder="Password">
            <div class="flex justify-end space-x-3">
                <button onclick="closePasswordModal()" class="mono-button-secondary px-4 py-2 rounded">Cancel</button>
                <button onclick="confirmPassword()" class="mono-button px-4 py-2 rounded">Confirm</button>
            </div>
        </div>
    </div>

    <!-- add password modal -->
    <div id="add-password-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50 hidden">
        <div class="cyber-border rounded-lg p-6 w-[500px]">
            <h3 class="text-xl font-bold mb-4 uppercase tracking-wider">Add Password</h3>
            <div class="space-y-4">
                <div>
                    <label class="text-xs text-white/50 uppercase tracking-wider">Service</label>
                    <input type="text" id="password-service" class="mono-input w-full px-4 py-2 rounded text-white" placeholder="e.g., Gmail, Facebook">
                </div>
                <div>
                    <label class="text-xs text-white/50 uppercase tracking-wider">Username/Email</label>
                    <input type="text" id="password-username" class="mono-input w-full px-4 py-2 rounded text-white" placeholder="Username or email">
                </div>
                <div>
                    <label class="text-xs text-white/50 uppercase tracking-wider">Password</label>
                    <div class="flex space-x-2">
                        <input type="password" id="password-value" class="mono-input flex-1 px-4 py-2 rounded text-white" placeholder="Password">
                        <button onclick="generatePassword()" class="mono-button-secondary px-4 py-2 rounded">Generate</button>
                        <button onclick="togglePasswordVisibility()" class="mono-button-secondary px-4 py-2 rounded">
                            <svg id="password-eye" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="mt-2 flex space-x-1">
                        <div class="strength-bar flex-1" id="strength-1"></div>
                        <div class="strength-bar flex-1" id="strength-2"></div>
                        <div class="strength-bar flex-1" id="strength-3"></div>
                        <div class="strength-bar flex-1" id="strength-4"></div>
                        <div class="strength-bar flex-1" id="strength-5"></div>
                    </div>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeAddPasswordModal()" class="mono-button-secondary px-4 py-2 rounded">Cancel</button>
                <button onclick="savePassword()" class="mono-button px-4 py-2 rounded">Save</button>
            </div>
        </div>
    </div>

    <!-- add totp modal -->
    <div id="add-totp-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50 hidden">
        <div class="cyber-border rounded-lg p-6 w-[500px]">
            <h3 class="text-xl font-bold mb-4 uppercase tracking-wider">Add 2FA</h3>
            <div class="space-y-4">
                <div>
                    <label class="text-xs text-white/50 uppercase tracking-wider">Service Name</label>
                    <input type="text" id="totp-service" class="mono-input w-full px-4 py-2 rounded text-white" placeholder="e.g., Google, GitHub">
                </div>
                <div>
                    <label class="text-xs text-white/50 uppercase tracking-wider">Secret Key</label>
                    <input type="text" id="totp-secret" class="mono-input w-full px-4 py-2 rounded text-white" placeholder="Enter the secret key">
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeAddTOTPModal()" class="mono-button-secondary px-4 py-2 rounded">Cancel</button>
                <button onclick="saveTOTP()" class="mono-button px-4 py-2 rounded">Add</button>
            </div>
        </div>
    </div>

    <!-- export file modal -->
    <div id="export-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center z-50 hidden">
        <div class="cyber-border rounded-lg p-6 w-[400px]">
            <h3 class="text-xl font-bold mb-4 uppercase tracking-wider">Export File</h3>
            <div class="space-y-4">
                <div>
                    <label class="text-xs text-white/50 uppercase tracking-wider">Filename</label>
                    <input type="text" id="export-filename" class="mono-input w-full px-4 py-2 rounded text-white" placeholder="aliases.ward" value="aliases.ward">
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeExportModal()" class="mono-button-secondary px-4 py-2 rounded">Cancel</button>
                <button onclick="confirmExport()" class="mono-button px-4 py-2 rounded">Export</button>
            </div>
        </div>
    </div>

    <!-- notifications -->
    <div id="notification-container" class="fixed bottom-4 right-4 z-[200] space-y-2">
        
    </div>

    <!-- file input -->
    <input type="file" id="file-input" accept=".ward" class="hidden">

    <!-- hidden iframe for photo loading -->
    <div id="photo-loader" style="position: fixed; top: -9999px; left: -9999px; width: 512px; height: 512px;">
        <img id="photo-img" crossorigin="anonymous" style="width: 512px; height: 512px;">
    </div>

    <script src="js/app.js"></script>
</body>
</html>